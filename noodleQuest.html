<!DOCTYPE html>
<html>
<head>
    <title>Noodle's Quest</title>
    <meta charset="utf-8">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function ()
        {
            var player =
                {
                    //TODO decide values
                    positionX: 0,
                    positionY: 0,
                    size:50,
                    warmth: 10,

                    //directions
                    idle: 0,
                    left: 1,
                    up: 2,
                    down: 3,
                    right: 4,

                    //TODO fix place holder below
                    image: "Images/Snake.png",
                    hasMouse: false,
                    Update: function ()
                    {

                        //player.positionX += 100; //TODO delete this

                        //move player based on direction 
                        switch (player.direction)
                        {
                            case player.left:
                                if (player.positionX > 0) { player.positionX -= 50; }
                                break;
                            case player.up:
                                if (player.positionY > 0) { player.positionY -= 50; }
                                break;
                            case player.down:
                                if (player.positionY < (50 * 4)) { player.positionY += 50; }
                                break;
                            case player.right:
                                if (player.positionX < (50 * 14)) { player.positionX += 50; }
                                break;
                            default:
                                break;
                        };

                        //TODO (check which squares player is in, lose one heat)

                        //TODO If sunlight, warmth = 10

                        //TODO If(warmth = 0) Game over

                        //TODO If hawk, display game over screen

                        //TODO If points, score += 5

                        //TODO If mouse, hasMouse = true

                        //TODO If home and hasMouse = true, display win screen
                    }
                };

            var canvas = $("#myCanvas");
            var context = canvas.get(0).getContext("2d");
            
            var drawImage = new Image();
            drawImage.src = player.image;
            drawImage.addEventListener("load", render, false);
            window.addEventListener("keyup", keyupHandler, false);
            window.addEventListener("keydown", keydownHandler, false);

            function render()
            {
                //clear the screen
                context.clearRect(0, 0, 800, 800);
                
                //TODO DrawMap
                var _image = new Image();
                var x = 1;
                var y = 1;
                var size = 50;
                
                // outer loop applies to outer array
                for (var i = 0, len = mapMatrix.length; i < len; i++) {
                    // inner loop applies to sub-arrays
                    for (var j = 0, len2 = mapMatrix[i].length; j < len2; j++) {
                        // accesses each element of each sub-array in turn
                        console.log(mapMatrix[i][j]);
                        //_image.src = "Images/Snake.png";
                        if (mapMatrix[i][j] == "home") { _image.src = "Images/Home.jpg"; }
                        else if (mapMatrix[i][j] == "mouse") { _image.src = "Images/Mouse.jpg"; }
                        else if (mapMatrix[i][j] == "empty") { _image.src = "Images/Grass.jpg"; }
                        else if (mapMatrix[i][j] == "rockWall") { _image.src = "Images/Rock.jpg"; }
                        else if (mapMatrix[i][j] == "sun") { _image.src = "Images/Sunlight.jpg"; }
                        else if (mapMatrix[i][j] == "pointSquare") { _image.src = "Images/PointSquare.jpg"; }
                        else { _image.src = "Images/PointSquareRevealed.png";}
                          
                        x = size * i;
                        y = size * j;
                        context.drawImage(_image, x, y, size, size);
                    };
                };
                //DrawPlayer
                context.drawImage(drawImage, player.positionX, player.positionY, player.size, player.size);

                    //TODO DrawSidebar
            }

            function keyupHandler(event)
            {
                //TODO fun stuff?
                player.Update();
                //map.Update();
                
                render();
                //player.direction = player.idle;
            };
            function keydownHandler(event)
            {
                //TODO If(arrow directions) move in that direction
                if (event.keyCode == 65) { /*move left*/ player.direction = player.left; }
                if (event.keyCode == 87) { /*move up*/ player.direction = player.up; }
                if (event.keyCode == 83) { /*move down*/ player.direction = player.down; }
                if (event.keyCode == 68) { /*move right*/ player.direction = player.right; }
                if (event.keyCode != 65 && event.keyCode != 68 && event.keyCode != 83 && event.keyCode != 87)
                { player.direction = player.idle; }
            };
            
            function Tile(_type, _image, _size)
            {
                this.type = _type;
                this.image = _image;
                this.size = _size;
            };

            function Hawk(_x, _y)
            {
                this.image = "Images/Hawk.jpg";
                this.positionX = _x;
                this.positionY = _y;
            };

            var mapMatrix = // width 5 height 15
                [

                    ["home", "empty", "empty", "empty", "sun"],
                    ["rockWall", "rockWall", "empty", "empty", "empty"],
                    ["sun", "empty", "empty", "rockWall", "empty"],
                    ["empty", "empty", "empty", "empty", "empty"],
                    ["empty", "empty", "sun", "rockWall", "rockWall"],
                    ["empty", "empty", "empty", "rockWall", "rockWall"],
                    ["empty", "empty", "empty", "empty", "sun"],
                    ["empty", "empty", "rockWall", "empty", "empty"],
                    ["empty", "sun", "empty", "empty", "empty"],
                    ["rockWall", "rockWall", "empty", "empty", "empty"],
                    ["rockWall", "rockWall", "empty", "empty", "empty"],
                    ["rockWall", "rockWall", "empty", "rockWall", "sun"],
                    ["sun", "empty", "empty", "empty", "empty"],
                    ["empty", "empty", "empty", "rockWall", "rockWall"],
                    ["empty", "sun", "empty", "empty", "mouse"]

                ];
          
            var map =
                {
                    size: 50,
                    //TODO figure out if this works
                    home: Tile( 0, "Images/Home.jpg", size),
                    mouse: Tile(1, "Images/Mouse.jpg", size),
                    empty: Tile(2, "Images/Grass.jpg", size),
                    sun: Tile(3, "Images/Sunlight.jpg", size),
                    pointsTile: Tile(4, "Images/PointSquare.jpg", size),
                    rockWall: Tile(5, "Images/Rock.jpg", size),
                    
                    //Hawk array of 2
                    hawk1: Hawk(3, 3),
                    hawk2: Hawk(3, 3),
                    hawks: [hawk1, hawk2],
                    score,

                    Update: function ()
                    {
                        //TODO move hawks using RnG
                        //Random number 0 - 3
                        //Math.floor(Math.random() * 4);
                        //TODO If (number = 0 & hawk.x > 0) Go left
                        //TODO Etc…
                        //TODO If(player.location = hawk.location) Game over
                        //TODO Decrease score by 1
                    },
                };

            function GameOver()
            {
                //TODO Game Over pop- up
                //TODO Refresh button
            };

            function Sidebar()
            {
                //TODO Title of game
                //TODO displays map.Score
                //TODO displays Player.Sunlight
                //TODO displays player.hasMouse
                //TODO Instructions
            };
        });    
        </script>
  </head >
            <body>
                <canvas id="myCanvas" width="800" height="400">
                    <!-- Insert fallback content here --> </canvas>

                <button id="change"></button>
            </body> 
</html >